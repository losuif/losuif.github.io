---
title: "[ABAP] OPEN SQL ë°ì´í„° ì½ê¸° - FOR ALL ENTRIES, GROUPING, SORT, SUBQUERY"
author: Jinsol
categories: SAP/ABAP
tags: SAP/ABAP
date: '2022-03-15'
# image: /assets/img/.png
---

<br>

## <span style="color:#711A75">**ğŸŒ OPEN SQL : ë°ì´í„° ì½ê¸° - WHERE**</span>
<hr>

<br>

### <span style="color:#711A75">**ğŸŒœ FOR ALL ENTRIES**</span>
<hr>

- ì¸í„°ë„ í…Œì´ë¸”ê³¼ ë°ì´í„° ë² ì´ìŠ¤ í…Œì´ë¸”ì„ JOIN í•˜ëŠ” ê°œë…ê³¼ ìœ ì‚¬

- LOOPë¥¼ ìˆ˜í–‰í•˜ë©´ì„œ SQL ìˆ˜í–‰

- **!!FOR ALL ENTRIES êµ¬ë¬¸ ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­!!**

    - ì¸í„°ë„ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ê³¼ ë¹„êµ ëŒ€ìƒ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ íƒ€ì…ì€ ê°™ì•„ì•¼ í•¨

    - LIKE, BETWEEN, INê³¼ ê°™ì€ ë¹„êµ êµ¬ë¬¸ ì‚¬ìš© ë¶ˆê°€

    - Unique Key ê¸°ì¤€, ì¸í„°ë„ í…Œì´ë¸”ì˜ ì¤‘ë³µëœ ê°’ì€ í•˜ë‚˜ë§Œ ë‚¨ìŒ

    - ì¸í„°ë„ í…Œì´ë¸”ì´ NULLì´ë©´ ëª¨ë“  ë°ì´í„°ë¥¼ ì½ì–´ì˜´ -> ë¹ˆ ê°’ì¸ì§€ ê¼­ ì²´í¬í•´ì•¼ í•¨!

    - ì¸í„°ë„ í…Œì´ë¸”ì˜ ìˆ˜ê°€ ë§ìœ¼ë©´ LOOP ìˆ˜ê°€ ì¦ê°€í•˜ë¯€ë¡œ SELECT ì†ë„ê°€ ì¤„ì–´ë“¦


- ex)

    ```
    REPORT ZTEST.

    DATA gt_spfli TYPE TABLE OF spfli.
    DATA gt_sflight TYPE TABLE OF sflight.
    DATA gs_sflight TYPE sflight.

    SELECT * FROM spfli
    INTO TABLE gt_spfli.

    SELECT * FROM sflight
        INTO TABLE gt_sflight
        FOR ALL ENTRIES IN gt_spfli
        WHERE carrid = gt_spfli-carrid
        AND connid = gt_spfli-connid.

    LOOP AT gt_sflight INTO gs_sflight.
        WRITE : / gs_sflight-carrid, gs_sflight-connid.
    ENDLOOP.
    ```
    
<br>
<br>

## <span style="color:#711A75">**ğŸŒ OPEN SQL : ë°ì´í„° ì½ê¸° - GROUPING**</span>
<hr>

> [GROUP BY / HAVING](https://losuif.github.io/2021/11/20/mysql06.html)

- AGGREGATE í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” SELECT êµ¬ë¬¸ì— GROUP BYë¥¼ ì‚¬ìš©í•´ì•¼ í•¨

    - AGGREGATE í•¨ìˆ˜ ì¢…ë¥˜ : AVG(í‰ê· ) / COUNT(ê°œìˆ˜) / MAX(ìµœëŒ“ê°’) / MIN(ìµœì†Ÿê°’) / STDDEV(í‘œì¤€í¸ì°¨) / SUM(í•©ê³„) / VARIANCE(ë¶„ì‚°)
    
<br>
<br>

## <span style="color:#711A75">**ğŸŒ OPEN SQL : ë°ì´í„° ì½ê¸° - SORT**</span>
<hr>

> [ORDER BY ASCENDING / DESCENDING](https://losuif.github.io/2021/11/17/mysql03.html)

- **ORDER BY PRIMARY KEY**

    - í…Œì´ë¸”ì˜ KEYì— ì˜í•´ ì •ë ¬

    - SELECT * êµ¬ë¬¸ì—ë§Œ ì‚¬ìš© ê°€ëŠ¥

    - JOIN êµ¬ë¬¸ ë° VIEWì—ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ

- ex)

    ```
    REPORT ZTEST.

    DATA : gt_itab TYPE STANDARD TABLE OF sflight,
        gs_wa TYPE sflight.

    SELECT * INTO TABLE gt_itab
        FROM sflight
        UP TO 10 ROWS
        WHERE carrid EQ 'AA'
        ORDER BY CONNID DESCENDING FLDATE DESCENDING.

    LOOP AT gt_itab INTO gs_wa.
     WRITE : / 'í•­ê³µì‚¬ì½”ë“œ : ', gs_wa-carrid, '/ ì—°ê²°ë²ˆí˜¸ : ', gs_wa-connid, ' / í•­ê³µí¸ì¼ì : ', gs_wa-fldate.
    ENDLOOP. 
    ```

    
<br>
<br>

## <span style="color:#711A75">**ğŸŒ OPEN SQL : ë°ì´í„° ì½ê¸° - SUBQUERY**</span>
<hr>

SELECT êµ¬ë¬¸ì˜ WHERE ì¡°ê±´ì— ë˜ ë‹¤ë¥¸ SELECT êµ¬ë¬¸ì„ ì¶”ê°€ í•´ ê°’ì„ ì œí•œí•˜ëŠ” ëª©ì ìœ¼ë¡œ ì‚¬ìš©

<br>

#### <span style="color:#711A75">**ğŸŒœ Scalar Subquery**</span>
<hr>

- SELECTì ˆ ì•ˆì— ê¸°ìˆ ëœ SELECTì ˆ, JOIN êµ¬ë¬¸ê³¼ ìœ ì‚¬í•œ ì—­í•  ìˆ˜í–‰

- Scalar Subqueryì˜ íŠ¹ì§•

    - ë°˜ë“œì‹œ í•œ ì»¬ëŸ¼ë§Œì„ ë°˜í™˜í•´ì•¼ í•¨

    - Nested Loop ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬ë¨

    - Scalar Subqueryê°€ ì‹¤í–‰ë˜ëŠ” íšŸìˆ˜ = row ìˆ˜

    - ë°˜ë³µë˜ëŠ” ì½”ë“œë‚˜ ë§ˆìŠ¤í„° ìœ í˜•ì˜ í…Œì´ë¸”ì„ ì¡°íšŒí•˜ëŠ” ê²½ìš° ì‚¬ìš©í•˜ë©´ íš¨ìœ¨ì 

- ex)

    ```
    REPORT ZTEST.

    DATA : gv_carrid TYPE sflight-carrid,
        gv_connid TYPE sflight-connid,
        gv_paymentsum TYPE sflight-paymentsum.

    SELECT SINGLE carrid connid paymentsum
        INTO (gv_carrid, gv_connid, gv_paymentsum)
        FROM sflight AS a
        WHERE carrid IN (SELECT carrid
                        FROM spfli
                        WHERE carrid = a~carrid
                        AND connid = a~connid)
        AND a~carrid = 'AA'.
    
    WRITE : gv_carrid,  gv_connid, gv_paymentsum.
    ```
    
<br>

#### <span style="color:#711A75">**ğŸŒœ Non-Scalar Subquery**</span>
<hr>

- Subqueryì˜ ê²°ê³¼ê°€ ì¡´ì¬í•˜ë©´ TRUEë¥¼, ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ FALSEë¥¼ ë°˜í™˜

- EXISTS êµ¬ë¬¸ì„ ì´ìš©í•´ êµ¬í˜„

- ex)

    ```
    REPORT ZTEST.

    DATA : gv_carrid TYPE sflight-carrid,
        gv_connid TYPE sflight-connid,
        gv_paymentsum TYPE sflight-paymentsum.

    SELECT SINGLE carrid connid paymentsum
        INTO (gv_carrid, gv_connid, gv_paymentsum)
        FROM sflight AS a
        WHERE EXISTS (SELECT *
                        FROM spfli
                        WHERE carrid = a~carrid
                        AND connid = a~connid)
        AND a~carrid = 'AA'.
    
    WRITE : gv_carrid,  gv_connid, gv_paymentsum.
    ```