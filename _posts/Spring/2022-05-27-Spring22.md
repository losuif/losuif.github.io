---
title: "[SpringBoot] ìŠ¤í”„ë§ë¶€íŠ¸ + JPAë¥¼ ì´ìš©í•œ CRUD êµ¬í˜„ 6. ì‚­ì œ ê¸°ëŠ¥ ë§Œë“¤ê¸°"
author: Jinsol
categories: SpringBoot
tags: SpringBoot
date: '2022-05-27'
image: /assets/img/springLogo.png
---

<br>

## <span style="color:#91C483">ğŸ‹ js</span>
<hr>

ë¨¼ì €, ìˆ˜ì • í˜ì´ì§€ì— ì‚­ì œ ë²„íŠ¼ì„ ë„£ì–´ì£¼ì.

src/main/resources/templates/posts-update.mustache

```html
<button type="button" class="btn btn-danger" id="btn-delete">ì‚­ì œ</button>
```

src/main/resources/static/js/app/index.js

```javascript
var main = {
    init : function(){
        ...
        $('#btn-delete').on('click', function(){
            _this.delete();
        });
    },

    save : function(){
        ...
    },

    update : function(){
        ...
    },

    delete : function(){
        var id = $('#id').val();

        $.ajax({
            type: 'DELETE',
            url: '/api/posts/'+id,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8'
        }).done(function(){
            alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            window.location.href= '/';
        }).fail(function (error){
            alert(JSON.stringify(error))
        });
    }
};

main.init();
```

<br>
<br>

## <span style="color:#91C483">ğŸ‹ Service</span>
<hr>

src/main/java/com/test/spring/boot_crud/service/posts/PostsService.java

```java
package com.test.spring.boot_crud.service.posts;

import ...

@RequiredArgsConstructor
@Service
public class PostsService {

    ...

    @Transactional
    public void delete(Long id) {
        Posts posts = postsRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException("í•´ë‹¹ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤."));
        postsRepository.delete(posts);
    }
}
```

<br>
<br>

## <span style="color:#91C483">ğŸ‹ Controller</span>
<hr>

src/main/java/com/test/spring/boot_crud/web/PostsApiController.java

```java
...
@DeleteMapping("/api/posts/{id}")
public Long delete(@PathVariable Long id) {
    postsService.delete(id);
    return id;
}
...
```

<br>
<br>

## <span style="color:#91C483">ğŸ‹ Public Key Retrieval is not allowed ì—ëŸ¬</span>
<hr>

![](/assets/img/boot_jpa_error_5.PNG)

~~ì–´íœ´ ã…‹ ì´ì   ì§œì¦ë„ ì•ˆë‚œë‹¤~~

`application.properties`ë¡œ ê°€ì„œ `allowPublicKeyRetrieval=true`ë¥¼ ì¶”ê°€í•´ì£¼ì.

ì˜ˆì „ì— JDBC ê³µë¶€í–ˆì„ ë•Œ ë´¤ë˜ ë‚´ìš©. -> [velog-JDBC ì‚¬ìš©í•˜ê¸°](https://velog.io/@losuif/JDBC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0)

```
spring.datasource.url=jdbc:mysql://localhost:3306/boottest?useSSL=false&useUnicode=true&serverTimezone=Asia/Seoul&allowPublicKeyRetrieval=true
```

**allowPublicKeyRetrieval=true** : 8.0 ì´í›„ ì„¤ì • ì¶”ê°€í•´ì•¼ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤!!

![](/assets/img/boot_jpa_delete.PNG)

![](/assets/img/boot_jpa_delete_02.PNG)
