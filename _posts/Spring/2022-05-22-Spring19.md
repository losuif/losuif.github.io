---
title: "[SpringBoot] ìŠ¤í”„ë§ë¶€íŠ¸ + JPAë¥¼ ì´ìš©í•œ CRUD êµ¬í˜„ 3. ë“±ë¡ ê¸°ëŠ¥ ë§Œë“¤ê¸°"
author: Jinsol
categories: SpringBoot
tags: SpringBoot
date: '2022-05-22'
image: /assets/img/springLogo.png
---

<br>

## <span style="color:#00FFAB">ğŸ‹ Controller</span>
<hr>

src/main/java/com/test/spring/boot_crud/web/PostsApiController.java

```java
package com.test.spring.boot_crud.web;

import com.test.spring.boot_crud.service.posts.PostsService;
import com.test.spring.boot_crud.web.dto.PostsSaveRequestDto;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

@RequiredArgsConstructor
@RestController
public class PostsApiController {

    private final PostsService postsService;

    @PostMapping("/api/posts")
    public Long save(@RequestBody PostsSaveRequestDto requestDto) {
        return postsService.save(requestDto);
    }
}
```

<br>

- @RequiredArgsConstructor : ì˜ì¡´ì„± ì£¼ì…(Dependency Injection) í™œìš©ì„ ìœ„í•´ ì‚¬ìš© / final í•„ë“œë‚˜ @NotNullì´ ë¶™ì€ ëª¨ë“  í•„ë“œì— ëŒ€í•´ ìƒì„±ìë¥¼ ìƒì„±í•´ì¤€ë‹¤.

- @RestController : @Controller + @ResponseBody / Controller í´ë˜ìŠ¤ì— @RestController ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì´ë©´ í•˜ìœ„ ë©”ì„œë“œ ë§ˆë‹¤ @ResponseBodyë¥¼ ì¶”ê°€í•˜ì§€ ì•Šì•„ë„ ê°ì²´ë¥¼ ë¬¸ìì—´ì´ë‚˜ JSONì˜ í˜•íƒœë¡œ ì „ì†¡í•  ìˆ˜ ìˆë‹¤.

- @RequestBody : HTTP ìš”ì²­ì˜ Body ë‚´ìš©ì„ í†µì§¸ë¡œ ìë°” ê°ì²´ë¡œ ë³€í™˜í•´ ë§¤í•‘ëœ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬

    - @ResponseBody : ìë°” ê°ì²´ë¥¼ HTTP ìš”ì²­ì˜ Body ë‚´ìš©ìœ¼ë¡œ ë§¤í•‘í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡
    
<br>
<br>

## <span style="color:#00FFAB">ğŸ‹ Service</span>
<hr>

src/main/java/com/test/spring/boot_crud/service/PostsService.java

```java
package com.test.spring.boot_crud.service.posts;

import com.test.spring.boot_crud.domain.posts.PostsRepository;
import com.test.spring.boot_crud.web.dto.PostsSaveRequestDto;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@RequiredArgsConstructor
@Service
public class PostsService {

    private final PostsRepository postsRepository;

    @Transactional
    public Long save(PostsSaveRequestDto requestDto) {
        return postsRepository.save(requestDto.toEntity()).getId();
    }
}
```

<br>

- @Transactional

- .save() : íŒŒë¼ë¯¸í„°ë¡œ ë“¤ì–´ì˜¨ entityê°€ ìƒˆë¡œìš´ ì—”í„°í‹°ë¼ë©´ `insert`, ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì—”í„°í‹°ë¼ë©´ `update`
    
<br>
<br>

## <span style="color:#00FFAB">ğŸ‹ Dto</span>
<hr>

src/main/java/com/test/spring/boot_crud/web/dto/PostsSaveRequestDto.java

```java
package com.test.spring.boot_crud.web.dto;

import com.test.spring.boot_crud.domain.posts.Posts;
import lombok.Builder;
import lombok.Getter;
import lombok.NoArgsConstructor;

@Getter
@NoArgsConstructor
public class PostsSaveRequestDto {

    private String title;
    private String content;
    private String author;

    @Builder
    public PostsSaveRequestDto(String title, String content, String author) {
        this.title = title;
        this.content = content;
        this.author = author;
    }

    public Posts toEntity(){
        return Posts.builder()
                .title(title)
                .content(content)
                .author(author)
                .build();
    }
}
```
    
<br>
<br>

## <span style="color:#00FFAB">ğŸ‹ ë“±ë¡ í˜ì´ì§€</span>
<hr>

src/main/resources/templates/posts-save.mustache

```html
{{>layout/header}}

<h1>ê²Œì‹œê¸€ ë“±ë¡</h1>

<div class="col-md-8">
    <div class="col-md-6">
        <form>
            <div class="form-group">
                <label for="title">ì œëª©</label>
                <input type="text" class="form-control" id="title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.">
            </div>
            <div class="form-group">
                <label for="author">ì‘ì„±ì</label>
                <input type="text" class="form-control" id="author" placeholder="ì‘ì„±ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.">
            </div>
            <div class="form-group">
                <label for="content">ë‚´ìš©</label>
                <input type="text" class="form-control" id="content" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.">
            </div>
        </form>
        <br>
        <div class="btn-group" role="group" aria-label="btns">
            <a href="/" role="button"><button type="button" class="btn btn-secondary">ì·¨ì†Œ</button></a>
            <button type="button" class="btn btn-warning" id="btn-save">ë“±ë¡</button>
        </div>
    </div>
</div>

{{>layout/footer}}
```

<br>
<br>

## <span style="color:#00FFAB">ğŸ‹ index.js</span>
<hr>

src/resources/static/js/app/index.js

```javascript
var main = {

    init : function(){
        var _this = this;
        $('#btn-save').on('click', function(){
            _this.save();
        });
    },

    save : function(){
        var data = {
            title: $('#title').val(),
            author: $('#author').val(),
            content: $('#content').val()
        };
        $.ajax({
            type: 'POST',
            url: '/api/posts',
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(data)
        }).done(function(){
            alert('ê²Œì‹œê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }).fail(function(error){
            alert(JSON.stringify(error));
        });
    }
};

main.init();
```

<br>
<br>

## <span style="color:#00FFAB">ğŸ‹ Controller</span>
<hr>

src/main/java/com/test/spring/boot_crud/web/IndexController.java

```java
package com.test.spring.boot_crud.web;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class IndexController {

    @GetMapping("/")
    public String index() {
        return "index";
    }

    @GetMapping("/posts/save")
    public String postsSave(){
        return "posts-save";
    }

}
```

<br>
<br>
<br>

![](/assets/img/boot_jpa_postsave.PNG)

![](/assets/img/boot_jpa_postsave_2.PNG)

![](/assets/img/boot_jpa_postsave_3.PNG)

