---
title: "[ìŠ¤í”„ë§] ìŠ¤í”„ë§ì—ì„œ DB ì—°ê²°í•˜ê¸° / DBì— ì…ë ¥í•œ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°"
author: Jinsol
categories: Spring
tags: Spring
date: '2021-12-24'
image: /assets/img/springLogo.png
---

<br>
<br>

## <span style="color:#146356">path ë³€ê²½í•˜ê¸°</span>
<hr>

ì„œë²„ ë”ë¸”í´ë¦­ - í•˜ë‹¨ Modules ì—ì„œ path ë³€ê²½í•˜ê³  ì €ì¥í•˜ê¸°

![](/assets/img/springdb07.png)

<br>
<br>

## <span style="color:#146356">MySQL - DB ìƒì„±í•˜ê¸°</span>
<hr>

```sql
create database springtest;
use springtest;

create table springtest(
	num			int 		unique auto_increment,
    uName		char(10)	not null,
    subject	char(30) 	not null,
    content		char(200)	not null,
    date		datetime	default NOW()
);

insert into springtest
(uName, subject, content, date)
values
('ë¦¬ìš°', 'ìŠ¤í”„ë§', 'ìŠ¤í”„ë§ì–´ë ¤ì›¡', now()),
('ë´ë²„', 'ìë°”', 'ìë°”ë„ì–´ë ¤ì›¡', now()),
('ë‚˜ì´ë¡œë¹„', 'ë°°ê³ í”„ë‹¤', 'ë‚´ì¼ë­ë¨¹ì§€', now()),
('ì‚°íƒ€', 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤', 'ë©”ë¦¬í¬ë¦¬ìŠ¤ë§ˆìŠ¤', now());

select * from springtest;
```

![](/assets/img/springdb01.PNG)

<br>
<br>

## <span style="color:#146356">VO ìƒì„±í•˜ê¸°</span>
<hr>

> - VO (Value Object)
>
> - ë„ë©”ì¸ ê°ì²´ì˜ ì¼ì¢…
>
> - read-Only
> 
> - ê´€ê³„ë°ì´í„°ë² ì´ìŠ¤ì˜ ë ˆì½”ë“œì— ëŒ€ì‘ë˜ëŠ” ìë°”í´ë˜ìŠ¤

`src/main/java/com` í•˜ìœ„ì— 'com.springtest.domain' íŒ¨í‚¤ì§€ ìƒì„±, TestVO.javaë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ ìƒì„±í–ˆë‹¤

```java
package com.springtest.domain;

import java.sql.Date;

public class TestVO {

	private int num;
	private String uName;
	private String subject;
	private String content;
	private Date date;
	
	public int getNum() {
		return num;
	}
	public String getuName() {
		return uName;
	}
	public String getSubject() {
		return subject;
	}
	public String getContent() {
		return content;
	}
	public Date getDate() {
		return date;
	}
}
```

<br>
<br>

## <span style="color:#146356">pom.xml</span>
<hr>

- java-versionì€ 1.8ë¡œ, springframework-versionì€ 4.3.18ë¡œ ë³€ê²½í•˜ê¸°

![](/assets/img/springdb02.png)

- `<dependencies>` íƒœê·¸ ì•ˆì— ì•„ë˜ ë‚´ìš© ë¶™ì—¬ë„£ê¸°

```
<!-- mysql -->
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>8.0.26</version>
</dependency>    

<!-- org.mybatis/mybatis -->
<dependency>
    <groupId>org.mybatis</groupId>
    <artifactId>mybatis</artifactId>
    <version>3.4.1</version>
</dependency>

<!-- mybatis-spring -->
<dependency>
    <groupId>org.mybatis</groupId>
    <artifactId>mybatis-spring</artifactId>
    <version>1.3.0</version>
</dependency>

<!-- spring-jdbc -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-jdbc</artifactId>
    <version>${org.springframework-version}</version>
</dependency>  
```

![](/assets/img/springdb03.png)

<br>
<br>

## <span style="color:#146356">root-context.xml</span>
<hr>

- `src/main/webapp/WEB-INF/spring/root-context.xml` í•˜ë‹¨ Namespaces

![](/assets/img/springdb04.png)

![](/assets/img/springdb05.png)

ìœ„ ì‚¬ì§„ê³¼ ë™ì¼í•˜ê²Œ ì²´í¬í•˜ê³  ì €ì¥í•´ì£¼ì

- ë‹¤ì‹œ Sourceë¡œ ëŒì•„ì™€ì„œ `<beans>` íƒœê·¸ ì•ˆì— ì•„ë˜ ë‚´ìš© ë¶™ì—¬ë„£ê¸°

```
<!-- MySQL  -->
    <bean class="org.springframework.jdbc.datasource.DriverManagerDataSource" id="dataSource">
    <property name="driverClassName" value="com.mysql.cj.jdbc.Driver"></property>
    <property name="url"
        value="jdbc:mysql://127.0.0.1:3306/test?useSSL=false&amp;serverTimezone=Asia/Seoul"></property>
    <property name="username" value="root"></property>
    <property name="password" value="ë¹„ë°€ë²ˆí˜¸"></property>
    </bean>
<!-- SqlSessionFactory  -->
    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
<!-- mybatis ì„¤ì •íŒŒì¼ì˜ ê²½ë¡œ -->
    <property name="configLocation" value="classpath:/mybatis-config.xml" />
<!-- mybatis mapper íŒŒì¼ì˜ ê²½ë¡œ -->
    <property name="mapperLocations" value="classpath:mappers/**/*Mapper.xml" />
    </bean>
    
    <bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate" destroy-method="clearCache">
        <constructor-arg name="sqlSessionFactory" ref="sqlSessionFactory"/>
    </bean>	
```

![](/assets/img/springdb06.png)


<br>
<br>

## <span style="color:#146356">mybatis-config.xml</span>
<hr>

`src/main/resources` í•˜ìœ„ì— `mybatis-config.xml` íŒŒì¼ ìƒì„±í•˜ê³  ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ê¸°

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE configuration
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-config.dtd">
<configuration>
</configuration>
```

<br>
<br>

## <span style="color:#146356">ë§¤í¼ xml ìƒì„±í•˜ê¸°</span>
<hr>

> - ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ” XML íŒŒì¼
>
> - MyBatisëŠ” XMLì— ì„¤ì •ëœ ì¿¼ë¦¬ë¥¼ ì½ì–´ ì‹¤í–‰ì‹œí‚¤ê²Œ ë¨

`src/main/resources` í•˜ìœ„ì— í´ë”ì™€ xml íŒŒì¼ ìƒì„±

src/main/resources/mappers/springTestMapper.xml

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="springTestMapper">
</mapper>
```

<br>
<br>

## <span style="color:#146356">JSP íŒŒì¼ ë§Œë“¤ê¸°</span>
<hr>

`src/main/webapp/web-INF/views` í•˜ìœ„ì— í´ë” ë§Œë“¤ê³  JSP íŒŒì¼ ìƒì„±í•˜ê¸°

src/main/webapp/web-INF/views/board/list.jsp

```html
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>

<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<meta charset="UTF-8">
<title>list</title>
</head>
<body>
	<form name="userForm">
		<h1>List Page</h1>
		<table>
			 <thead>
				  <tr>
					  <th scope="col">ë²ˆí˜¸</th>
					  <th scope="col">ì´ë¦„</th>
					  <th scope="col">ì œëª©</th>
					  <th scope="col">ë‚´ìš©</th>
					  <th scope="col">ì‘ì„±ì¼</th>
				  </tr>
			 </thead>
			 
			 <tbody>
				 <c:forEach items="${list}" var="list">
					 <tr>
				        <td class="text_ct">${list.num}&nbsp;</td>
				        <td class="text_ct">${list.uName}&nbsp;</td>
				        <td class="text_ct">${list.subject}&nbsp;</td>
				        <td class="text_ct">${list.content}&nbsp;</td>
				        <td class="text_ct"><fmt:formatDate value="${list.date}" pattern="yyyy/MM/dd" /></td>
					 </tr>
				</c:forEach>
			 </tbody> 
		</table>
	</form>
</body>
</html>
```

<br>
<br>

## <span style="color:#146356">Controller ë§Œë“¤ê¸°</span>
<hr>

> - controller : ì‚¬ìš©ìì˜ ìš”ì²­ì´ ì§„ì…í•˜ëŠ” ì§€ì  (entry point)
> 
> - ìš”ì²­ì— ë”°ë¼ ì–´ë–¤ ì²˜ë¦¬ë¥¼ í•  ì§€ ê²°ì •
> 
> - controllerëŠ” ê²°ì •ë§Œ í•˜ëŠ” ê²ƒì´ê³  ì‹¤ì§ˆì ì¸ ì²˜ë¦¬ëŠ” Serviceì—ì„œ ë‹´ë‹¹
> 
> - ì‚¬ìš©ìì—ê²Œ Viewë¥¼ ì‘ë‹µìœ¼ë¡œ ë³´ë‚´ì¤Œ
>

`src/main/java` í•˜ìœ„ controller íŒ¨í‚¤ì§€ì— ìƒì„±

com.springtest.controller/TestController.java

```java
package com.springtest.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
@RequestMapping("/board/*")
public class TestController {

	@RequestMapping(value="/list", method = RequestMethod.GET)
	public void getList() throws Exception {
		
	}
	
}
```

url ë§¤í•‘ì„ í•´ ì¤€ ëŒ€ë¡œ `http://localhost/board/list`ì— ë“¤ì–´ê°€ë³´ë©´

![](/assets/img/springdb08.png)

ì§œìŸŒ~ğŸ˜†

<br>
<br>

## <span style="color:#146356">ë§¤í¼ ì‘ì„±í•˜ê¸°</span>
<hr>

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.springtest.mappers.board">
	<!-- ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ -->
	<select id="list" resultType="com.springtest.domain.TestVO">
		select
	 		num, uName, subject, content, date
	 	from springtest
	</select>
</mapper>
```

<br>
<br>

## <span style="color:#146356">DAO ìƒì„±</span>
<hr>

> [DAOë€?](https://losuif.github.io/2021/11/07/JSP13.html) 

- `src/main/java` í•˜ìœ„ì— `com.springtest.dao` íŒ¨í‚¤ì§€ ìƒì„±, ì•ˆì— `testDAO.java` í´ë˜ìŠ¤(ì¸í„°í˜ì´ìŠ¤) ìƒì„±

```java
package com.springtest.dao;

import java.util.List;

import com.springtest.domain.TestVO;

public interface testDAO {
	public List<TestVO> list();
}
```

- ë™ì¼ íŒ¨í‚¤ì§€ í•˜ìœ„ì— testDAOë¥¼ ìƒì†ë°›ëŠ” `testDAOImpl.java` í´ë˜ìŠ¤ ìƒì„±

```java
package com.springtest.dao;

import java.util.List;

import javax.inject.Inject;

import org.apache.ibatis.session.SqlSession;
import org.springframework.stereotype.Repository;

import com.springtest.domain.TestVO;

@Repository
public class testDAOImpl implements testDAO {

	
	@Inject
	private SqlSession sqlSession;
	
	private static String namespace = "com.springtest.mappers.board";
	
	@Override
	public List<TestVO> list() {
		return sqlSession.selectList(namespace + ".list");
	}

}
```

<br>
<br>

## <span style="color:#146356">Service ìƒì„±</span>
<hr>

- `src/main/java` í•˜ìœ„ì— `com.springtest.service` íŒ¨í‚¤ì§€ ìƒì„±, ì•ˆì— `testService.java` í´ë˜ìŠ¤(ì¸í„°í˜ì´ìŠ¤) ìƒì„±

```java
package com.springtest.service;

import java.util.List;

import com.springtest.domain.TestVO;

public interface testService {
	public List<TestVO> list();
}
```

- ë™ì¼ íŒ¨í‚¤ì§€ í•˜ìœ„ì— testServiceë¥¼ ìƒì†ë°›ëŠ” `testServiceImpl.java` í´ë˜ìŠ¤ ìƒì„±

```java
package com.springtest.service;

import java.util.List;

import javax.inject.Inject;

import org.springframework.stereotype.Service;

import com.springtest.dao.testDAO;
import com.springtest.domain.TestVO;
@Service
public class testServiceImpl implements testService {

	@Inject
	private testDAO dao;
	
	@Override
	public List<TestVO> list() {
		return dao.list();
	}
	
}
```

<br>
<br>

## <span style="color:#146356">Controller ì‘ì„±</span>
<hr>

```java
package com.springtest.controller;

import java.util.List;

import javax.inject.Inject;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

import com.springtest.domain.TestVO;
import com.springtest.service.testService;

@Controller
@RequestMapping("/board/*")
public class TestController {

	@Inject
	private testService service;
	
	@RequestMapping(value="/list", method = RequestMethod.GET)
	public String getList(Model model) {
		List<TestVO> list = service.list();
		model.addAttribute("list", list);
		return "board/list";
	}
	
}
```

<br>
<br>

## <span style="color:#146356">root-context.xml ì‘ì„±</span>
<hr>

`<beans>` íƒœê·¸ ì•ˆ í•˜ë‹¨ì— ì•„ë˜ ì½”ë“œ ì‘ì„±

```
<context:component-scan base-package="com.springtest.domain" />

<context:component-scan base-package="com.springtest.dao" />

<context:component-scan base-package="com.springtest.service" />
```

<br>
<br>
<br>
<br>

ì‹¤í–‰ í•´ ë³´ë©´ DBì— ì…ë ¥í•œ ê°’ë“¤ì„ ì˜ ì½ì–´ì˜¤ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë‹¤ ã…ã…

![](/assets/img/springdb09.png)


<br>
<br>

## <span style="color:#146356">ì£¼ì˜ì‚¬í•­</span>
<hr>

**!! ì£¼ì˜í•  ì  !! ë§¤í¼ì˜ namespaceì™€ ì¸í„°í˜ì´ìŠ¤ DAOë¥¼ ìƒì†ë°›ëŠ” DAOImpl í´ë˜ìŠ¤ì˜ namespaceëŠ” ì¼ì¹˜í•´ì•¼ í•œë‹¤**

![](/assets/img/springdb10.png)

![](/assets/img/springdb11.png)